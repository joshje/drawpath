define("config",[],function(){return{fps:30}}),define("vec2",[],function(){var t=function(t,i){this.x=t||0,this.y=i||0};t.prototype={reset:function(t,i){return this.x=t,this.y=i,this},toString:function(t){t=t||3;var i=Math.pow(10,t);return"["+Math.round(this.x*i)/i+", "+Math.round(this.y*i)/i+"]"},clone:function(){return new t(this.x,this.y)},copyTo:function(t){t.x=this.x,t.y=this.y},copyFrom:function(t){this.x=t.x,this.y=t.y},magnitude:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},magnitudeSquared:function(){return this.x*this.x+this.y*this.y},normalise:function(){var t=this.magnitude();return this.x=this.x/t,this.y=this.y/t,this},reverse:function(){return this.x=-this.x,this.y=-this.y,this},plusEq:function(t){return this.x+=t.x,this.y+=t.y,this},plusNew:function(i){return new t(this.x+i.x,this.y+i.y)},minusEq:function(t){return this.x-=t.x,this.y-=t.y,this},minusNew:function(i){return new t(this.x-i.x,this.y-i.y)},multiplyEq:function(t){return this.x*=t,this.y*=t,this},multiplyNew:function(t){var i=this.clone();return i.multiplyEq(t)},divideEq:function(t){return this.x/=t,this.y/=t,this},divideNew:function(t){var i=this.clone();return i.divideEq(t)},dot:function(t){return this.x*t.x+this.y*t.y},angle:function(t){return Math.atan2(this.y,this.x)*(t?1:i.TO_DEGREES)},rotate:function(t,s){var e=Math.cos(t*(s?1:i.TO_RADIANS)),n=Math.sin(t*(s?1:i.TO_RADIANS));return i.temp.copyFrom(this),this.x=i.temp.x*e-i.temp.y*n,this.y=i.temp.x*n+i.temp.y*e,this},equals:function(t){return this.x==t.x&&this.y==t.y},isCloseTo:function(t,s){return this.equals(t)?!0:(i.temp.copyFrom(this),i.temp.minusEq(t),i.temp.magnitudeSquared()<s*s)},rotateAroundPoint:function(t,s,e){i.temp.copyFrom(this),i.temp.minusEq(t),i.temp.rotate(s,e),i.temp.plusEq(t),this.copyFrom(i.temp)},isMagLessThan:function(t){return this.magnitudeSquared()<t*t},isMagGreaterThan:function(t){return this.magnitudeSquared()>t*t},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}};var i={TO_DEGREES:180/Math.PI,TO_RADIANS:Math.PI/180,temp:new t};return t}),define("utils",[],function(){return{createEl:function(t,i){var s=document.createElement(t);return i&&(s.className=i),document.body.appendChild(s),s},hsl:function(t,i,s){return"hsl("+t%360+", "+Math.floor(i)+"%, "+Math.floor(s)+"%)"},withinRect:function(t,i,s,e){return t.x>=i.x&&t.x<=i.x+s&&t.y>=i.y&&t.y<=i.y+e}}}),define("canvas",["vec2","utils"],function(t,i){var s=function(s){this.el=i.createEl("canvas",s),this.ctx=this.el.getContext("2d"),this.clear=function(){this.ctx.clearRect(0,0,this.width,this.height)},this.setCursor=function(t){this.cursor!==t&&(this.cursor=t,this.newCursor=t)},this.updateCursor=function(){this.newCursor&&(this.el.style.cursor=this.newCursor,this.newCursor=!1)},this.resize=function(){var i=window.innerWidth,s=window.innerHeight;(i!==this.width||s!==this.height)&&(this.width=i,this.height=s,this.half=new t(this.width,this.height).multiplyEq(.5).floor(),this.el.width=this.width,this.el.height=this.height)},this.resize(),setInterval(this.resize.bind(this),200)};return new s("drawpath-canvas")}),define("grid",["vec2","canvas"],function(t,i){var s=i.ctx,e=function(){this.spacing=10,this.pos=new t,this.update=function(){this.pos.reset(i.half.x-.5,i.half.y-.5)},this.render=function(){s.save(),s.translate(this.pos.x,this.pos.y),s.beginPath();for(var t=Math.ceil(i.width/this.spacing*.5);--t;){var e=t*this.spacing;s.moveTo(e,-i.half.y),s.lineTo(e,i.half.y),s.moveTo(-e,i.half.y),s.lineTo(-e,-i.half.y)}for(t=Math.ceil(i.height/this.spacing*.5);--t;){var n=t*this.spacing;s.moveTo(-i.half.x,n),s.lineTo(i.half.x,n),s.moveTo(i.half.x,-n),s.lineTo(-i.half.x,-n)}s.strokeStyle="#EEE",s.lineWidth=1,s.stroke(),s.beginPath(),s.moveTo(0,-i.half.y),s.lineTo(0,i.half.y),s.moveTo(-i.half.x,0),s.lineTo(i.half.x,0),s.strokeStyle="#CCC",s.stroke(),s.restore()}};return new e}),define("point",["vec2","canvas","utils"],function(t,i,s){var e=i.ctx,n=function(t,i){this.hue=i,this.fillStyle=s.hsl(i,100,50),this.pos=t,this.radius=3,this.render=function(){e.beginPath(),e.arc(this.pos.x,this.pos.y,this.radius,0,2*Math.PI),this.active||this.hovered?(e.fillStyle="#FFF",e.fill(),e.strokeStyle=this.fillStyle,e.strokeWidth=1,e.stroke()):(e.fillStyle=this.fillStyle,e.fill())},this.activate=function(){this.active=!0},this.deactivate=function(){this.active=!1},this.moveTo=function(t){this.pos=t.clone()},this.nudge=function(t,i){this.pos.x+=t,this.pos.y+=i}};return n}),define("mouse",["vec2","canvas","utils"],function(t,i,s){var e=i.ctx,n=function(){this.offset=new t(i.el.offsetTop,i.el.offsetLeft),this.pos=new t,this.centerPos=new t,this.clicks=[],this.radius=5,this.update=function(){i.setCursor("none"),this.strokeStyle=this.hue?s.hsl(this.hue,50,50):"#000"},this.render=function(){this.insideCanvas&&"none"===i.cursor&&(e.save(),e.translate(this.pos.x-.5,this.pos.y-.5),e.beginPath(),e.moveTo(-6,0),e.lineTo(-2,0),e.moveTo(2,0),e.lineTo(6,0),e.moveTo(0,-6),e.lineTo(0,-2),e.moveTo(0,2),e.lineTo(0,6),e.strokeStyle=this.strokeStyle,e.stroke(),e.restore())},this.onDown=function(t){this.insideCanvas&&(this.updatePos(t.clientX,t.clientY),this.snapToStart(),this.startPos=this.centerPos.clone(),this.clicks.push({pos:this.pos.clone(),centerPos:this.centerPos.clone()}))},this.onMove=function(t){this.updatePos(t.clientX,t.clientY),this.startPos&&(this.dragPos=this.centerPos.clone()),this.snapToStart()},this.onUp=function(t){this.updatePos(t.clientX,t.clientY),this.startPos=this.dragPos=null,this.snapToStart()},this.onOver=function(){this.insideCanvas=!0},this.onOut=function(){this.insideCanvas=!1},this.updatePos=function(t,s){this.pos.reset(t,s).minusEq(this.offset),this.centerPos=this.pos.clone().minusEq(i.half),this.snapToGrid&&(this.centerPos.divideEq(10).round().multiplyEq(10),this.pos=this.centerPos.clone().plusEq(i.half))},this.snapToStart=function(){this.insideCanvas&&this.vectorStartPos&&this.centerPos.isCloseTo(this.vectorStartPos,5)&&(this.centerPos=this.vectorStartPos.clone(),this.pos=this.centerPos.clone().plusEq(i.half))},this.toggleSnapToGrid=function(){this.snapToGrid=!this.snapToGrid},this.flush=function(){this.clicks=[]},window.addEventListener("mousedown",this.onDown.bind(this)),window.addEventListener("mousemove",this.onMove.bind(this)),window.addEventListener("mouseup",this.onUp.bind(this)),i.el.addEventListener("mouseover",this.onOver.bind(this)),i.el.addEventListener("mouseout",this.onOut.bind(this))};return new n}),define("code",["vec2","utils"],function(t,i){var s=function(){this.el=i.createEl("div","drawpath-code"),this.el.setAttribute("contentEditable",!0),this.clear=function(){this.lines=[]},this.addLine=function(t){this.lines.push(t||"")},this.render=function(){this.code=this.lines.join("\n<br>"),this.lastCode&&this.lastCode==this.code||(this.el.innerHTML=this.code,this.lastCode=this.code)},this.onClick=function(t){t.stopPropagation()},this.onFocus=function(){setTimeout(function(){var t=document.createRange();t.selectNodeContents(this.el);var i=window.getSelection();i.removeAllRanges(),i.addRange(t)}.bind(this),0)},this.el.addEventListener("click",this.onClick.bind(this)),this.el.addEventListener("focus",this.onFocus.bind(this))};return new s}),define("vector",["vec2","canvas","vectors","point","utils","mouse","code"],function(t,i,s,e,n,o,h){var r=i.ctx,c=function(t,c){this.list=[],this.pos=t,this.hue=c,this.strokeStyle=n.hsl(this.hue,100,50),this.update=function(){this.forEach(function(t){t.isDragging&&o.dragPos||o.startPos&&o.startPos.isCloseTo(t.pos,5)?(this.makeActive(t),t.isDragging=!0,o.dragPos&&t.moveTo(o.dragPos)):t.isDragging=!1,t.hovered=!1,o.centerPos.isCloseTo(t.pos,5)&&(t.hovered=!0,(!t.isFirst||this.isClosed)&&i.setCursor("pointer"))}.bind(this))},this.render=function(t){return this.renderLines(t),t&&this.renderMouseLine(),o.insideCanvas&&this.renderPoints(),this.code},this.renderLines=function(t){this.forEach(function(t){t.isFirst?(r.beginPath(),h.addLine("ctx.beginPath();"),r.strokeStyle=this.strokeStyle,r.moveTo(t.pos.x,t.pos.y),h.addLine("ctx.moveTo("+t.pos.x+", "+t.pos.y+");")):(r.lineTo(t.pos.x,t.pos.y),h.addLine("ctx.lineTo("+t.pos.x+", "+t.pos.y+");"))}.bind(this)),t&&!this.getLast().pos.isCloseTo(o.centerPos,5)&&h.addLine("ctx.lineTo("+o.centerPos.x+", "+o.centerPos.y+");"),this.isClosed&&(r.closePath(),h.addLine("ctx.closePath();")),r.stroke(),h.addLine()},this.renderMouseLine=function(){var t=this.getLast();t&&(r.moveTo(t.pos.x,t.pos.y),r.lineTo(o.centerPos.x,o.centerPos.y),r.strokeStyle=n.hsl(this.hue,100,75),r.stroke())},this.renderPoints=function(){this.forEach(function(t){t.render()})},this.getFirst=function(){return this.list[0]},this.getLast=function(){return this.list.length?this.list[this.list.length-1]:void 0},this.forEach=function(t){if("function"==typeof t)for(var i=0,s=this.list.length;s>i;i++)t(this.list[i],i)},this.addPoint=function(t){var i=new e(t,this.hue);this.list.length||(i.isFirst=!0),this.list.push(i),this.makeActive(i),this.updateMouseStartPos()},this.closePath=function(){this.isClosed=!0,this.active&&this.active.deactivate(),this.updateMouseStartPos()},this.deactivate=function(){this.active&&this.active.deactivate(),this.active=null},this.makeActive=function(t){s&&s.makeActive(this),this.active&&this.active.deactivate(),this.active=t,t.activate(),this.updateMouseStartPos()},this.updateMouseStartPos=function(){this.isClosed&&(o.vectorStartPos=null),o.vectorStartPos=this.list[0]&&this.list[0].pos}};return c}),define("vectors",["vec2","canvas","vector","mouse"],function(t,i,s,e){var n=i.ctx,o=function(){this.list=[],this.pos=new t,this.update=function(){this.pos.reset(i.half.x-.5,i.half.y-.5),this.forEach(function(t){t.update()}),"none"==i.cursor&&e.clicks.forEach(function(t){if(!t.hasFired){var i=t.centerPos.clone(),s=this.active;s&&s.deactivate(),(!s||s.isClosed)&&(s=this.addVector(i));var e=s.getFirst();e&&e.pos.equals(i)?s.closePath():s.addPoint(i)}}.bind(this))},this.render=function(){n.save(),n.translate(this.pos.x,this.pos.y),this.forEach(function(t){var s="none"==i.cursor&&t.active&&e.insideCanvas&&!t.isClosed;t.render(s)}.bind(this)),n.restore()},this.getFirst=function(){return this.list[0]},this.getLast=function(){return this.list.length?this.list[this.list.length-1]:void 0},this.forEach=function(t){if("function"==typeof t)for(var i=0,s=this.list.length;s>i;i++)t(this.list[i],i)},this.addVector=function(t){var i=100*this.list.length,e=new s(t,i);return this.list.push(e),this.makeActive(e),e},this.nudgeActivePoint=function(t,i){this.active&&this.active.active&&this.active.active.nudge(t,i)},this.makeActive=function(t){this.active&&this.active.deactivate(),e.hue=t.hue,this.active=t}};return new o}),define("keyboard",["mouse","vectors"],function(t,i){var s=function(){this.key={UP:38,LEFT:37,RIGHT:39,DOWN:40,S:83,PLUS:187,MINUS:189},this.onKeydown=function(s){var e=s.shiftKey?10:1;switch(s.keyCode){case this.key.UP:i.nudgeActivePoint(0,-e);break;case this.key.DOWN:i.nudgeActivePoint(0,e);break;case this.key.LEFT:i.nudgeActivePoint(-e,0);break;case this.key.RIGHT:i.nudgeActivePoint(e,0);break;case this.key.S:t.toggleSnapToGrid()}},window.addEventListener("keydown",this.onKeydown.bind(this))};return new s}),define("controls",["vec2","canvas","mouse","utils"],function(t,i,s,e){var n=i.ctx,o=function(){this.buttons=[],this.buttons.push(new h({name:"snapToGrid",icon:function(){n.beginPath(),n.moveTo(7,3),n.lineTo(7,17),n.moveTo(13,3),n.lineTo(13,17),n.moveTo(3,7),n.lineTo(17,7),n.moveTo(3,13),n.lineTo(17,13)},checkActive:function(){this.active=s.snapToGrid},onClick:function(){s.snapToGrid=!s.snapToGrid},x:10,y:10})),this.update=function(){this.hovered=null,this.buttons.forEach(function(t){t.update(),t.hovered&&(this.hovered=t)}.bind(this))},this.render=function(){this.buttons.forEach(function(t){t.hovered||t.render()}),this.hovered&&this.hovered.render()}},h=function(o){this.pos=new t(o.x,o.y),this.icon=o.icon,this.checkActive=o.checkActive,this.onClick=o.onClick,this.fillIcon=o.fillIcon,this.size=26,this.update=function(){this.checkActive&&this.checkActive(),this.hovered=e.withinRect(s.pos,this.pos,this.size,this.size),this.hovered&&i.setCursor("pointer"),s.clicks.forEach(function(t){!t.hasFired&&e.withinRect(t.pos,this.pos,this.size,this.size)&&(this.onClick(),t.hasFired=!0)}.bind(this))},this.render=function(){n.save(),n.translate(this.pos.x-.5,this.pos.y-.5),n.beginPath(),n.rect(2,2,this.size,this.size),n.fillStyle="rgba(0,0,0,0.1",n.fill(),n.beginPath(),n.rect(0,0,this.size,this.size),n.fillStyle=this.active?"#EEE":"#FFF",n.fill(),n.strokeStyle=this.hovered?"#AAA":"#CCC",n.lineWidth=1,n.stroke(),n.translate(3,3),this.icon&&this.icon(),n.strokeStyle="rgba(0, 0, 0, 0.5)",n.stroke(),n.restore()}};return new o}),require(["config","canvas","grid","vectors","mouse","keyboard","code","controls"],function(t,i,s,e,n,o,h,r){var c=function(){i.clear(),h.clear(),n.update(),s.update(),r.update(),e.update(),s.render(),e.render(),h.render(),r.render(),n.render(),i.updateCursor(),n.flush(),setTimeout(c,1e3/t.fps)};c()}),define("drawpath",function(){});
//# sourceMappingURL=drawpath.min.js.map